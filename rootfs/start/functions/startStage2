startStage2(){
   local isFirstRun=$1
   readEnvironmentVars
   if [ "$isFirstRun" == "true" ]
   then
      createLinuxUser
      updateSudoersConf
      fixHosts
      makeAllFromList "$(allVars noquote)"
      fixPermissionsForUsrLocalBin
      local finalCmdString="$VAR_FINAL_COMMAND &"
      tryRunStage 3
      if [ "$VAR_FINAL_CMD_AS_ROOT" != "yes" ] && [ "$VAR_LINUX_USER" != "root" ]
      then
         finalCmdString="/usr/local/bin/sudo -u $VAR_LINUX_USER $finalCmdString"
      fi
      {
         echo -e "$finalCmdString"
         echo 'PID=$!'
         echo 'wait $PID'
         echo 'trap - TERM INT'
         echo 'wait $PID'
         echo 'EXIT_STATUS=$?'
      } >> /stop/stage1
   else
      tryRunStage 3
   fi
   allVars quote > /environment/vars
   execCmd /stop/stage1
}
